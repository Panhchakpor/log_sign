<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dashboard ‚Äî Crystal Book World</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">

  <style>
    /* ===== General ===== */
    body,
    html {
      margin: 0;
      padding: 0;
      font-family: 'Inter', sans-serif;
      background: #1a0a2a;
      color: white;
    }

    .layout {
      display: flex;
      height: 100vh;
      overflow: hidden;
    }

    /* ===== Sidebar ===== */
    .sidebar {
      width: 250px;
      background: linear-gradient(180deg, #4b0f76, #6b2c91);
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px 0;
      box-shadow: 2px 0 20px rgba(0, 0, 0, 0.5);
    }

    .brand {
      display: flex;
      flex-direction: column;
      align-items: center;
      margin-bottom: 40px;
    }

    .avatar {
      width: 70px;
      height: 70px;
      background: #ff6b81;
      border-radius: 50%;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 2rem;
      font-weight: 700;
      box-shadow: 0 0 20px rgba(255, 107, 129, 0.7);
    }

    .brand-title {
      margin-top: 10px;
      font-weight: 600;
      font-size: 1.2rem;
    }

    .brand-sub {
      font-size: 0.9rem;
      color: #f0d6f7;
    }

    .nav {
      display: flex;
      flex-direction: column;
      width: 100%;
    }

    .nav-btn {
      background: transparent;
      border: none;
      color: #f0d6f7;
      padding: 12px 20px;
      margin: 5px 0;
      font-size: 1rem;
      text-align: left;
      cursor: pointer;
      border-radius: 10px;
      transition: all 0.3s ease;
    }

    .nav-btn:hover,
    .nav-btn.active {
      background: rgba(255, 255, 255, 0.1);
      box-shadow: 0 0 15px rgba(255, 107, 129, 0.6);
    }

    .ghost {
      margin-top: auto;
      padding: 10px 20px;
      border: 2px solid #ff6b81;
      border-radius: 25px;
      background: transparent;
      color: #ff6b81;
      cursor: pointer;
      font-weight: 600;
      transition: all 0.3s ease;
    }

    .ghost:hover {
      background: #ff6b81;
      color: white;
      box-shadow: 0 0 20px rgba(255, 107, 129, 0.7);
    }

    /* ===== Main ===== */
    .main {
      flex: 1;
      padding: 30px;
      overflow-y: auto;
      background: linear-gradient(135deg, #1a0a2a, #3b0b44);
    }

    .main-header h1 {
      font-size: 2.5rem;
      color: #ffb6b9;
      text-shadow: 0 0 20px rgba(255, 182, 185, 0.7);
      margin-bottom: 30px;
      animation: floatTitle 4s ease-in-out infinite alternate;
    }

    @keyframes floatTitle {
      0% {
        transform: translateY(0px);
      }

      100% {
        transform: translateY(-10px);
      }
    }

    .card {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 20px;
      padding: 25px;
      margin-bottom: 30px;
      box-shadow: 0 0 30px rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(10px);
      transition: transform 0.3s, box-shadow 0.3s;
    }

    .card:hover {
      transform: translateY(-5px);
      box-shadow: 0 0 50px rgba(255, 107, 129, 0.5);
    }

    /* Info Grid */
    .info-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      gap: 20px;
      margin-top: 20px;
    }

    .info-item {
      padding: 10px;
    }

    .info-item .label {
      font-size: 0.9rem;
      color: #f0d6f7;
      margin-bottom: 5px;
    }

    .info-item .value {
      font-size: 1.1rem;
      font-weight: 600;
      color: #ffb6b9;
    }

    .status {
      color: #6bffb6;
    }

    /* Actions */
    .actions {
      margin-top: 20px;
    }

    .actions .primary {
      background: linear-gradient(45deg, #ff6b81, #ffb6b9);
      border: none;
      padding: 10px 20px;
      border-radius: 25px;
      cursor: pointer;
      font-weight: 600;
      box-shadow: 0 0 20px rgba(255, 107, 129, 0.7);
      transition: all 0.3s ease;
    }

    .actions .primary:hover {
      transform: scale(1.05);
      box-shadow: 0 0 35px rgba(255, 107, 129, 0.9);
    }

    /* Option Container */
    .option-container {
      display: flex;
      flex-wrap: wrap;
      gap: 30px;
      justify-content: center;
      margin-top: 20px;
    }

    .option-card {
      width: 200px;
      height: 220px;
      background: linear-gradient(145deg, rgba(255, 94, 142, 0.15), rgba(255, 182, 185, 0.05));
      border-radius: 20px;
      backdrop-filter: blur(15px);
      color: white;
      text-align: center;
      padding: 20px;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 0 15px rgba(255, 107, 129, 0.2);
    }

    .option-card:hover {
      transform: translateY(-10px) scale(1.05);
      box-shadow: 0 0 50px rgba(255, 107, 129, 0.6);
      background: linear-gradient(145deg, rgba(255, 94, 142, 0.3), rgba(255, 182, 185, 0.1));
    }

    .option-card h2 {
      margin-bottom: 10px;
      color: #ff6b81;
    }

    .option-card p {
      font-size: 0.9rem;
      color: #f0d6f7;
    }

    /* Book Cards */
    .book-container {
      display: flex;
      flex-wrap: wrap;
      gap: 15px;
      margin-top: 10px;
    }

    .book-card {
      background: rgba(255, 255, 255, 0.05);
      padding: 10px;
      border-radius: 15px;
      width: 150px;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 0 10px rgba(255, 107, 129, 0.2);
    }

    .book-card:hover {
      transform: scale(1.05);
      box-shadow: 0 0 30px rgba(255, 107, 129, 0.5);
    }

    /* Modals */
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      justify-content: center;
      align-items: center;
      z-index: 10;
    }

    .modal.open {
      display: flex;
    }

    .modal-panel {
      background: rgba(255, 255, 255, 0.05);
      backdrop-filter: blur(10px);
      padding: 25px;
      border-radius: 20px;
      box-shadow: 0 0 30px rgba(255, 107, 129, 0.4);
      width: 350px;
      max-width: 90%;
      position: relative;
    }

    /* Scrollbar */
    .main::-webkit-scrollbar {
      width: 8px;
    }

    .main::-webkit-scrollbar-thumb {
      background: rgba(255, 107, 129, 0.5);
      border-radius: 5px;
    }

    .main::-webkit-scrollbar-track {
      background: rgba(255, 255, 255, 0.05);
    }
  </style>
</head>

<body>
  <div class="layout">
    <aside class="sidebar">
      <div class="brand">
        <div class="avatar" id="avatarInitials"></div>
        <div class="brand-text">
          <div class="brand-title">Welcome</div>
          <div class="brand-sub">your info</div>
        </div>
      </div>
      <nav class="nav">
        <button class="nav-btn active" id="dashboardBtn">Dashboard</button>
        <button class="nav-btn" id="profileBtnSidebar">Profile</button>
        <button class="nav-btn" id="settingsBtn">Settings</button>
      </nav>
      <button class="ghost" id="logoutBtn">Logout</button>
    </aside>

    <main class="main">
      <!-- Dashboard Page -->
      <div id="dashboardPage">
        <header class="main-header">
          <h1 id="usernameDisplay"></h1>
        </header>

        <section class="card big-card">
          <h2>Account Overview</h2>
          <div class="info-grid">
            <div class="info-item">
              <div class="label">Email</div>
              <div class="value" id="emailDisplayLarge"></div>
            </div>
            <div class="info-item">
              <div class="label">Last Login</div>
              <div class="value" id="lastLoginDisplay"></div>
            </div>
            <div class="info-item">
              <div class="label">Status</div>
              <div class="value status">Active</div>
            </div>
            <div class="info-item">
              <div class="label">Total Logins</div>
              <div class="value" id="loginCount"></div>
            </div>
          </div>
          <div class="actions">
            <button class="primary" id="logoutBtn2">Logout</button>
          </div>
        </section>

        <section class="card big-card">
          <h2>Explore Your Book World</h2>
          <div class="option-container">
            <div class="option-card" data-action="continue-reading">
              <h2>Continue Reading</h2>
              <p>You can read but cannot resume where you left off</p>
            </div>
            <div class="option-card" data-action="reading-part">
              <h2>Reading Part</h2>
              <p>Dive into chapters by genre</p>
            </div>
            <div class="option-card" data-action="buy-hardcover">
              <h2>Buy Hardcover</h2>
              <p>View books by genre and price</p>
            </div>
            <div class="option-card" data-action="buy-paperback">
              <h2>Buy Paperback</h2>
              <p>View books by genre and price</p>
            </div>
          </div>
        </section>
      </div>

      <!-- Reading Page -->
      <div id="readingPage" style="display:none;">
        <h2>Reading Part</h2>
        <div id="reading-mystery" class="book-container"></div>
        <div id="reading-fantasy" class="book-container"></div>
        <div id="reading-scifi" class="book-container"></div>
        <div id="reading-romance" class="book-container"></div>
        <button class="ghost" onclick="showDashboard()">Back to Dashboard</button>
      </div>

      <!-- Buy Hardcover Page -->
      <div id="buyHardcoverPage" style="display:none;">
        <h2>Buy Hardcover Books</h2>
        <div id="buying-mystery" class="book-container"></div>
        <div id="buying-fantasy" class="book-container"></div>
        <div id="buying-scifi" class="book-container"></div>
        <div id="buying-romance" class="book-container"></div>
        <button class="ghost" onclick="showDashboard()">Back to Dashboard</button>
      </div>

      <!-- Buy Paperback Page -->
      <div id="buyPaperbackPage" style="display:none;">
        <h2>Buy Paperback Books</h2>
        <div id="buying-mystery-paper" class="book-container"></div>
        <div id="buying-fantasy-paper" class="book-container"></div>
        <div id="buying-scifi-paper" class="book-container"></div>
        <div id="buying-romance-paper" class="book-container"></div>
        <button class="ghost" onclick="showDashboard()">Back to Dashboard</button>
      </div>
    </main>
  </div>

  <!-- Profile Modal -->
  <div id="profileModal" class="modal">
    <div class="modal-panel">
      <h3>Edit Profile</h3>
      <label>Username</label><input id="profileUsername" type="text">
      <label>Email</label><input id="profileEmail" type="email">
      <h4>Change Password</h4>
      <label>Current Password</label><input id="oldPassword" type="password">
      <label>New Password</label><input id="newPassword" type="password">
      <div style="margin-top:20px; display:flex; gap:10px;">
        <button class="primary" id="saveProfileBtn" style="flex:1;">Save</button>
        <button class="ghost" onclick="closeModal('profileModal')" style="flex:1;">Cancel</button>
      </div>
    </div>
  </div>

  <!-- Settings Modal -->
  <div id="settingsModal" class="modal">
    <div class="modal-panel">
      <h3>Settings</h3>
      <label>Theme</label>
      <select id="themeSelect">
        <option value="pastel">Pastel</option>
        <option value="light">Light</option>
        <option value="cute">Cute</option>
        <option value="dark">Dark Mode üåô</option>
      </select>
      <div style="display:flex; gap:10px; margin-top:10px;">
        <button class="primary" onclick="closeModal('settingsModal')" style="flex:1;">Done</button>
        <button class="ghost" onclick="closeModal('settingsModal')" style="flex:1;">Cancel</button>
      </div>
    </div>
  </div>

  <script>
    // ===== Data =====
    const readingBooks = [
      { title: "Mystery of the Lost Key", genre: "Mystery" },
      { title: "Haunted Nights", genre: "Mystery" },
      { title: "Dragons of Eternity", genre: "Fantasy" },
      { title: "The Wizard's Realm", genre: "Fantasy" },
      { title: "Galactic Wars", genre: "Sci-Fi" },
      { title: "Time Traveler", genre: "Sci-Fi" },
      { title: "Love in Paris", genre: "Romance" },
      { title: "Forever Yours", genre: "Romance" }
    ];
    const buyingBooks = [
      { title: "Mystery of the Lost Key", genre: "Mystery", format: "Hardcover", price: "$25" },
      { title: "Haunted Nights", genre: "Mystery", format: "Paperback", price: "$15" },
      { title: "Dragons of Eternity", genre: "Fantasy", format: "Hardcover", price: "$30" },
      { title: "The Wizard's Realm", genre: "Fantasy", format: "Paperback", price: "$18" },
      { title: "Galactic Wars", genre: "Sci-Fi", format: "Hardcover", price: "$28" },
      { title: "Time Traveler", genre: "Sci-Fi", format: "Paperback", price: "$16" },
      { title: "Love in Paris", genre: "Romance", format: "Hardcover", price: "$22" },
      { title: "Forever Yours", genre: "Romance", format: "Paperback", price: "$14" }
    ];

    // ===== Dashboard Logic =====
    window.addEventListener("DOMContentLoaded", () => {
      const currentUser = JSON.parse(localStorage.getItem("currentUser"));
      if (!currentUser) location.href = "login.html";

      document.getElementById("usernameDisplay").textContent = "Hello, " + currentUser.username + "!";
      document.getElementById("emailDisplayLarge").textContent = currentUser.email;
      document.getElementById("lastLoginDisplay").textContent = currentUser.lastActive || "First login";
      document.getElementById("loginCount").textContent = currentUser.loginCount || 1;
      document.getElementById("avatarInitials").textContent = currentUser.username[0].toUpperCase();

      const dashboardPage = document.getElementById("dashboardPage");
      const readingPage = document.getElementById("readingPage");
      const buyHardcoverPage = document.getElementById("buyHardcoverPage");
      const buyPaperbackPage = document.getElementById("buyPaperbackPage");

      const genres = ["Mystery", "Fantasy", "Sci-Fi", "Romance"];
      const optionCards = document.querySelectorAll(".option-card");

      function showDashboard() {
        dashboardPage.style.display = "block";
        readingPage.style.display = "none";
        buyHardcoverPage.style.display = "none";
        buyPaperbackPage.style.display = "none";
      }
      window.showDashboard = showDashboard;

      optionCards.forEach(card => {
        card.addEventListener("click", () => {
          const action = card.getAttribute("data-action");
          showDashboard(); // first hide all pages

          if (action === "continue-reading") {
            alert("You can read the book, but cannot save your progress!");
          } else if (action === "reading-part") {
            dashboardPage.style.display = "none";
            readingPage.style.display = "block";
            genres.forEach(g => {
              const container = document.getElementById(`reading-${g.toLowerCase()}`);
              container.innerHTML = "";
              readingBooks.filter(b => b.genre === g).forEach(b => {
                const div = document.createElement("div");
                div.className = "book-card";
                div.innerHTML = `<h4>${b.title}</h4><p>${b.genre}</p>`;
                div.onclick = () => alert(`Opening ${b.title}...`);
                container.appendChild(div);
              });
            });
          } else if (action === "buy-hardcover") {
            dashboardPage.style.display = "none";
            buyHardcoverPage.style.display = "block";
            genres.forEach(g => {
              const container = document.getElementById(`buying-${g.toLowerCase()}`);
              container.innerHTML = "";
              buyingBooks.filter(b => b.genre === g && b.format === "Hardcover").forEach(b => {
                const div = document.createElement("div");
                div.className = "book-card";
                div.innerHTML = `<h4>${b.title}</h4><p>${b.genre}</p><p>${b.price}</p>`;
                div.onclick = () => alert(`Viewing ${b.title}, price: ${b.price}`);
                container.appendChild(div);
              });
            });
          } else if (action === "buy-paperback") {
            dashboardPage.style.display = "none";
            buyPaperbackPage.style.display = "block";
            genres.forEach(g => {
              const container = document.getElementById(`buying-${g.toLowerCase()}-paper`);
              container.innerHTML = "";
              buyingBooks.filter(b => b.genre === g && b.format === "Paperback").forEach(b => {
                const div = document.createElement("div");
                div.className = "book-card";
                div.innerHTML = `<h4>${b.title}</h4><p>${b.genre}</p><p>${b.price}</p>`;
                div.onclick = () => alert(`Viewing ${b.title}, price: ${b.price}`);
                container.appendChild(div);
              });
            });
          }
        });
      });

      // Profile Modal
      const profileModal = document.getElementById("profileModal");
      document.getElementById("profileBtnSidebar").onclick = () => {
        profileModal.classList.add("open");
        document.getElementById("profileUsername").value = currentUser.username;
        document.getElementById("profileEmail").value = currentUser.email;
      };
      document.getElementById("saveProfileBtn").onclick = () => {
        const newName = document.getElementById("profileUsername").value;
        const newEmail = document.getElementById("profileEmail").value;
        currentUser.username = newName;
        currentUser.email = newEmail;
        localStorage.setItem("currentUser", JSON.stringify(currentUser));
        document.getElementById("usernameDisplay").textContent = "Hello, " + newName + "!";
        document.getElementById("emailDisplayLarge").textContent = newEmail;
        document.getElementById("avatarInitials").textContent = newName[0].toUpperCase();
        closeModal("profileModal");
        alert("Profile saved!");
      };

      // Settings Modal
      const settingsModal = document.getElementById("settingsModal");
      document.getElementById("settingsBtn").onclick = () => settingsModal.classList.add("open");
      document.getElementById("themeSelect").onchange = (e) => {
        const val = e.target.value;
        if (val === "dark") document.body.style.background = "#1a0a2a";
        else if (val === "light") document.body.style.background = "#f5f5f5", document.body.style.color = "#000";
        else if (val === "pastel") document.body.style.background = "linear-gradient(135deg, #ff9a9e, #fad0c4)";
        else if (val === "cute") document.body.style.background = "#ffd1dc";
      };

      // Logout
      ["logoutBtn", "logoutBtn2"].forEach(id => {
        document.getElementById(id).onclick = () => {
          if (confirm("Are you sure you want to logout?")) {
            localStorage.removeItem("currentUser");
            location.href = "login.html";
          }
        }
      });
    });

    function closeModal(id) { document.getElementById(id).classList.remove("open"); }
  </script>

  <!-- AI Chatbot Styles -->
  <style>
    /* Chatbot Floating Button */
    .chat-fab {
      position: fixed;
      bottom: 30px;
      right: 30px;
      width: 65px;
      height: 65px;
      border-radius: 50%;
      background: linear-gradient(135deg, #ff6b81, #ffb6b9);
      border: none;
      cursor: pointer;
      box-shadow: 0 5px 25px rgba(255, 107, 129, 0.5);
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
      z-index: 1000;
      animation: pulse 2s infinite;
    }

    .chat-fab:hover {
      transform: scale(1.1);
      box-shadow: 0 8px 35px rgba(255, 107, 129, 0.7);
    }

    .chat-fab svg {
      width: 30px;
      height: 30px;
      fill: white;
    }

    @keyframes pulse {

      0%,
      100% {
        box-shadow: 0 5px 25px rgba(255, 107, 129, 0.5);
      }

      50% {
        box-shadow: 0 5px 35px rgba(255, 107, 129, 0.8);
      }
    }

    /* Chat Window */
    .chat-window {
      position: fixed;
      bottom: 110px;
      right: 30px;
      width: 380px;
      height: 500px;
      background: rgba(26, 10, 42, 0.95);
      backdrop-filter: blur(20px);
      border-radius: 25px;
      box-shadow: 0 10px 50px rgba(0, 0, 0, 0.5), 0 0 30px rgba(255, 107, 129, 0.3);
      display: none;
      flex-direction: column;
      overflow: hidden;
      z-index: 999;
      border: 1px solid rgba(255, 107, 129, 0.3);
      animation: slideUp 0.3s ease;
    }

    .chat-window.open {
      display: flex;
    }

    @keyframes slideUp {
      from {
        opacity: 0;
        transform: translateY(20px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* Chat Header */
    .chat-header {
      background: linear-gradient(135deg, #4b0f76, #6b2c91);
      padding: 18px 20px;
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .chat-header-avatar {
      width: 45px;
      height: 45px;
      background: linear-gradient(135deg, #ff6b81, #ffb6b9);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.2rem;
      box-shadow: 0 0 15px rgba(255, 107, 129, 0.5);
    }

    .chat-header-info h4 {
      margin: 0;
      color: #ffb6b9;
      font-size: 1.1rem;
    }

    .chat-header-info span {
      font-size: 0.8rem;
      color: #6bffb6;
    }

    .chat-close {
      margin-left: auto;
      background: none;
      border: none;
      color: #f0d6f7;
      font-size: 1.5rem;
      cursor: pointer;
      padding: 5px;
      transition: color 0.3s;
    }

    .chat-close:hover {
      color: #ff6b81;
    }

    /* Chat Messages */
    .chat-messages {
      flex: 1;
      padding: 20px;
      overflow-y: auto;
      display: flex;
      flex-direction: column;
      gap: 15px;
    }

    .chat-messages::-webkit-scrollbar {
      width: 6px;
    }

    .chat-messages::-webkit-scrollbar-thumb {
      background: rgba(255, 107, 129, 0.5);
      border-radius: 3px;
    }

    .chat-message {
      max-width: 85%;
      padding: 12px 16px;
      border-radius: 18px;
      font-size: 0.95rem;
      line-height: 1.5;
      animation: fadeIn 0.3s ease;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(10px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .chat-message.bot {
      background: rgba(255, 255, 255, 0.1);
      color: #f0d6f7;
      align-self: flex-start;
      border-bottom-left-radius: 5px;
    }

    .chat-message.user {
      background: linear-gradient(135deg, #ff6b81, #ffb6b9);
      color: white;
      align-self: flex-end;
      border-bottom-right-radius: 5px;
    }

    .chat-message.typing {
      display: flex;
      gap: 5px;
      padding: 15px 20px;
    }

    .chat-message.typing span {
      width: 8px;
      height: 8px;
      background: #ff6b81;
      border-radius: 50%;
      animation: bounce 1.4s infinite ease-in-out;
    }

    .chat-message.typing span:nth-child(1) {
      animation-delay: 0s;
    }

    .chat-message.typing span:nth-child(2) {
      animation-delay: 0.2s;
    }

    .chat-message.typing span:nth-child(3) {
      animation-delay: 0.4s;
    }

    @keyframes bounce {

      0%,
      80%,
      100% {
        transform: translateY(0);
      }

      40% {
        transform: translateY(-10px);
      }
    }

    /* Chat Input */
    .chat-input-container {
      padding: 15px 20px;
      background: rgba(75, 15, 118, 0.5);
      display: flex;
      gap: 10px;
      align-items: center;
    }

    .chat-input {
      flex: 1;
      padding: 12px 18px;
      border: none;
      border-radius: 25px;
      background: rgba(255, 255, 255, 0.1);
      color: white;
      font-size: 0.95rem;
      outline: none;
      transition: all 0.3s;
    }

    .chat-input::placeholder {
      color: rgba(240, 214, 247, 0.6);
    }

    .chat-input:focus {
      background: rgba(255, 255, 255, 0.15);
      box-shadow: 0 0 15px rgba(255, 107, 129, 0.3);
    }

    .chat-send {
      width: 45px;
      height: 45px;
      border-radius: 50%;
      background: linear-gradient(135deg, #ff6b81, #ffb6b9);
      border: none;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s;
      box-shadow: 0 3px 15px rgba(255, 107, 129, 0.4);
    }

    .chat-send:hover {
      transform: scale(1.1);
      box-shadow: 0 5px 20px rgba(255, 107, 129, 0.6);
    }

    .chat-send:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none;
    }

    .chat-send svg {
      width: 20px;
      height: 20px;
      fill: white;
    }

    /* Responsive */
    @media (max-width: 480px) {
      .chat-window {
        width: calc(100% - 30px);
        right: 15px;
        bottom: 100px;
        height: 60vh;
      }

      .chat-fab {
        right: 20px;
        bottom: 20px;
      }
    }
  </style>

  <!-- AI Chatbot HTML -->
  <button class="chat-fab" id="chatFab" title="Chat with AI Assistant">
    <svg viewBox="0 0 24 24">
      <path d="M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H6l-2 2V4h16v12z" />
      <circle cx="8" cy="10" r="1.5" />
      <circle cx="12" cy="10" r="1.5" />
      <circle cx="16" cy="10" r="1.5" />
    </svg>
  </button>

  <div class="chat-window" id="chatWindow">
    <div class="chat-header">
      <div class="chat-header-avatar">ü§ñ</div>
      <div class="chat-header-info">
        <h4>Crystal AI Assistant</h4>
        <span>‚óè Online</span>
      </div>
      <button class="chat-close" id="chatClose">√ó</button>
    </div>
    <div class="chat-messages" id="chatMessages">
      <div class="chat-message bot">
        Hi there! üëã I'm your Crystal Book World AI assistant. I can help you discover books, get recommendations, or
        answer any questions. How can I help you today?
      </div>
    </div>
    <div class="chat-input-container">
      <input type="text" class="chat-input" id="chatInput" placeholder="Type your message..." autocomplete="off">
      <button class="chat-send" id="chatSend">
        <svg viewBox="0 0 24 24">
          <path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z" />
        </svg>
      </button>
    </div>
  </div>

  <!-- AI Chatbot JavaScript -->
  <script>
    // ===== AI Chatbot Logic =====
    (function () {
      const chatFab = document.getElementById('chatFab');
      const chatWindow = document.getElementById('chatWindow');
      const chatClose = document.getElementById('chatClose');
      const chatInput = document.getElementById('chatInput');
      const chatSend = document.getElementById('chatSend');
      const chatMessages = document.getElementById('chatMessages');

      // Book database for recommendations
      const bookDatabase = {
        mystery: [
          { title: "Mystery of the Lost Key", author: "Sarah Collins", rating: 4.5, description: "A thrilling detective story." },
          { title: "Haunted Nights", author: "James Morrison", rating: 4.3, description: "Spine-chilling mystery in an old mansion." },
          { title: "The Silent Witness", author: "Emily Drake", rating: 4.7, description: "Courtroom drama meets detective work." }
        ],
        fantasy: [
          { title: "Dragons of Eternity", author: "Michael Storm", rating: 4.8, description: "Epic fantasy with dragon riders." },
          { title: "The Wizard's Realm", author: "Luna Starweaver", rating: 4.6, description: "Magic school adventures await." },
          { title: "Enchanted Forest", author: "Oliver Green", rating: 4.4, description: "Mystical creatures and ancient prophecies." }
        ],
        scifi: [
          { title: "Galactic Wars", author: "Alex Nova", rating: 4.5, description: "Space battles and alien diplomacy." },
          { title: "Time Traveler", author: "Dr. Henry Wells", rating: 4.7, description: "Mind-bending temporal adventures." },
          { title: "Android Dreams", author: "Kate Silicon", rating: 4.3, description: "AI consciousness explored." }
        ],
        romance: [
          { title: "Love in Paris", author: "Sophie Laurent", rating: 4.4, description: "Romantic adventures in the city of love." },
          { title: "Forever Yours", author: "Emma Heart", rating: 4.6, description: "A timeless love story." },
          { title: "Summer Romance", author: "Lily Rose", rating: 4.2, description: "Beach vacation turns magical." }
        ]
      };

      // AI Response patterns
      const aiResponses = {
        greetings: [
          "Hello! üëã How can I help you explore Crystal Book World today?",
          "Hi there! Ready to discover some amazing books?",
          "Welcome! I'm here to help you find your next great read! üìö"
        ],
        recommendations: [
          "Based on popular choices, I'd recommend checking out our Fantasy section! 'Dragons of Eternity' is a fan favorite! üêâ",
          "Looking for something exciting? Our Mystery collection has some real page-turners!",
          "For a heartwarming read, our Romance section has beautiful stories waiting for you! üíï"
        ],
        bookInfo: (book) => `üìñ **${book.title}** by ${book.author}\n‚≠ê Rating: ${book.rating}/5\n${book.description}`,
        genreHelp: "We have 4 amazing genres:\n‚Ä¢ üîç Mystery - Thrilling detective stories\n‚Ä¢ üêâ Fantasy - Magic and adventure\n‚Ä¢ üöÄ Sci-Fi - Space and technology\n‚Ä¢ üíï Romance - Love stories",
        navigation: "I can help you navigate! Here's what you can do:\n‚Ä¢ üìö **Reading Part** - Browse and read books\n‚Ä¢ üì¶ **Buy Hardcover** - Purchase premium editions\n‚Ä¢ üìÑ **Buy Paperback** - Affordable options\n‚Ä¢ üë§ **Profile** - Edit your information",
        fallback: [
          "That's interesting! Would you like book recommendations or help navigating the dashboard?",
          "I'm here to help! Try asking about book recommendations, genres, or how to use the dashboard.",
          "Great question! I can help with book suggestions, finding specific genres, or explaining dashboard features."
        ]
      };

      // Toggle chat window
      chatFab.addEventListener('click', () => {
        chatWindow.classList.toggle('open');
        if (chatWindow.classList.contains('open')) {
          chatInput.focus();
        }
      });

      chatClose.addEventListener('click', () => {
        chatWindow.classList.remove('open');
      });

      // Send message function
      function sendMessage() {
        const message = chatInput.value.trim();
        if (!message) return;

        // Add user message
        addMessage(message, 'user');
        chatInput.value = '';
        chatSend.disabled = true;

        // Show typing indicator
        showTyping();

        // Generate AI response after delay
        setTimeout(() => {
          removeTyping();
          const response = generateAIResponse(message);
          addMessage(response, 'bot');
          chatSend.disabled = false;
        }, 800 + Math.random() * 700);
      }

      // Add message to chat
      function addMessage(text, sender) {
        const messageDiv = document.createElement('div');
        messageDiv.className = `chat-message ${sender}`;
        messageDiv.innerHTML = formatMessage(text);
        chatMessages.appendChild(messageDiv);
        chatMessages.scrollTop = chatMessages.scrollHeight;
      }

      // Format message with markdown-like syntax
      function formatMessage(text) {
        return text
          .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
          .replace(/\n/g, '<br>');
      }

      // Show typing indicator
      function showTyping() {
        const typingDiv = document.createElement('div');
        typingDiv.className = 'chat-message bot typing';
        typingDiv.id = 'typingIndicator';
        typingDiv.innerHTML = '<span></span><span></span><span></span>';
        chatMessages.appendChild(typingDiv);
        chatMessages.scrollTop = chatMessages.scrollHeight;
      }

      // Remove typing indicator
      function removeTyping() {
        const typing = document.getElementById('typingIndicator');
        if (typing) typing.remove();
      }

      // Generate AI response based on user input
      function generateAIResponse(input) {
        const lowerInput = input.toLowerCase();

        // Greetings
        if (/^(hi|hello|hey|good morning|good afternoon|good evening)/i.test(lowerInput)) {
          return randomChoice(aiResponses.greetings);
        }

        // Genre queries
        if (lowerInput.includes('mystery') || lowerInput.includes('detective')) {
          const book = randomChoice(bookDatabase.mystery);
          return `üîç Mystery lovers rejoice! Here's a great pick:\n\n${aiResponses.bookInfo(book)}`;
        }

        if (lowerInput.includes('fantasy') || lowerInput.includes('magic') || lowerInput.includes('dragon')) {
          const book = randomChoice(bookDatabase.fantasy);
          return `üêâ Fantasy adventure awaits!\n\n${aiResponses.bookInfo(book)}`;
        }

        if (lowerInput.includes('sci-fi') || lowerInput.includes('science fiction') || lowerInput.includes('space')) {
          const book = randomChoice(bookDatabase.scifi);
          return `üöÄ Blast off with this Sci-Fi gem!\n\n${aiResponses.bookInfo(book)}`;
        }

        if (lowerInput.includes('romance') || lowerInput.includes('love')) {
          const book = randomChoice(bookDatabase.romance);
          return `üíï Romance for the heart:\n\n${aiResponses.bookInfo(book)}`;
        }

        // Recommendation requests
        if (lowerInput.includes('recommend') || lowerInput.includes('suggest') || lowerInput.includes('what should i read')) {
          const genres = Object.keys(bookDatabase);
          const randomGenre = genres[Math.floor(Math.random() * genres.length)];
          const book = randomChoice(bookDatabase[randomGenre]);
          return `üìö Based on what's popular, I recommend:\n\n${aiResponses.bookInfo(book)}\n\nWant recommendations from a specific genre?`;
        }

        // Genre list
        if (lowerInput.includes('genre') || lowerInput.includes('categories') || lowerInput.includes('what books')) {
          return aiResponses.genreHelp;
        }

        // Navigation help
        if (lowerInput.includes('how') || lowerInput.includes('navigate') || lowerInput.includes('help') || lowerInput.includes('use')) {
          return aiResponses.navigation;
        }

        // Price/buying queries
        if (lowerInput.includes('price') || lowerInput.includes('buy') || lowerInput.includes('cost') || lowerInput.includes('hardcover') || lowerInput.includes('paperback')) {
          return "üí∞ Great question about purchases!\n\n**Hardcover books**: $22 - $30\n**Paperback books**: $14 - $18\n\nClick on 'Buy Hardcover' or 'Buy Paperback' in the dashboard to browse and purchase!";
        }

        // Reading queries
        if (lowerInput.includes('read') || lowerInput.includes('reading')) {
          return "üìñ Ready to read?\n\nClick on **'Continue Reading'** to resume a book, or **'Reading Part'** to explore our library by genre!\n\nWhat genre interests you?";
        }

        // Profile/account queries
        if (lowerInput.includes('profile') || lowerInput.includes('account') || lowerInput.includes('settings')) {
          return "üë§ Account Options:\n\n‚Ä¢ **Profile** - Edit your username and email\n‚Ä¢ **Settings** - Change theme (Pastel, Light, Cute, Dark)\n‚Ä¢ **Logout** - Sign out safely\n\nClick on any option in the sidebar!";
        }

        // Thank you
        if (lowerInput.includes('thank') || lowerInput.includes('thanks')) {
          return "You're welcome! üòä Feel free to ask if you need anything else. Happy reading! üìö";
        }

        // Goodbye
        if (lowerInput.includes('bye') || lowerInput.includes('goodbye')) {
          return "Goodbye! üëã Enjoy your reading journey at Crystal Book World! Come back anytime!";
        }

        // Best books query
        if (lowerInput.includes('best') || lowerInput.includes('top') || lowerInput.includes('popular')) {
          return "üèÜ **Top Rated Books:**\n\nüêâ Dragons of Eternity - 4.8‚≠ê\n‚è∞ Time Traveler - 4.7‚≠ê\n‚öñÔ∏è The Silent Witness - 4.7‚≠ê\nüíï Forever Yours - 4.6‚≠ê\n\nWant details on any of these?";
        }

        // Default/fallback response
        return randomChoice(aiResponses.fallback);
      }

      // Helper: Random choice from array
      function randomChoice(arr) {
        return arr[Math.floor(Math.random() * arr.length)];
      }

      // Event listeners
      chatSend.addEventListener('click', sendMessage);
      chatInput.addEventListener('keypress', (e) => {
        if (e.key === 'Enter') sendMessage();
      });

      // Close chat when clicking outside
      document.addEventListener('click', (e) => {
        if (!chatWindow.contains(e.target) && !chatFab.contains(e.target)) {
          chatWindow.classList.remove('open');
        }
      });
    })();
  </script>

</body>

</html>